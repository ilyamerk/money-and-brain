<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Деньги и Мозг — Конкурс заявок</title>
  <meta name="description" content="Конкурс стартапов: подай заявку, узнай правила и сроки, познакомься с призами и жюри." />
  <meta name="theme-color" content="#0f172a" id="meta-theme-color" />
  <meta property="og:title" content="Деньги и Мозг — Конкурс" />
  <meta property="og:description" content="Подавай заявку и становись частью будущего!" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/og-image.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400..800&family=Unbounded:wght@600..900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#ffffff; --bg-2:#f8fafc; --card:#ffffff; --card-stroke:#e5e7eb;
      --text:#0f172a; --muted:#6b7280; --acc:#7a183a; --acc-2:#a12545; --ok:#16a34a; --err:#dc2626;
      --radius:22px; --shadow:0 10px 30px rgba(0,0,0,.35);
      --pad:clamp(16px,2.2vw,28px); --max:1100px; 
      --font-ui:'Manrope', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif; 
      --font-display:'Unbounded', 'Manrope', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    html{scroll-behavior:smooth}
    body{margin:0;background:radial-gradient(1200px 600px at 10% -10%,rgba(122,24,58,.10),transparent),
                    radial-gradient(900px 500px at 110% 10%,rgba(161,37,69,.08),transparent),
                    linear-gradient(180deg,var(--bg),var(--bg-2));
         color:var(--text);font:16px/1.6 var(--font-ui);margin:auto;padding:0 var(--pad)}
    header.site-header{position:sticky;top:0;z-index:40;backdrop-filter:saturate(140%) blur(10px);
      background:rgba(255,255,255,.85);border-bottom:1px solid var(--card-stroke)}
    .nav{display:flex;align-items:center;gap:16px;justify-content:space-between;padding:10px var(--pad)}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--acc),var(--acc-2));box-shadow:var(--shadow)}
    .brand h1{font-size:18px;margin:0;letter-spacing:.2px;font-family:var(--font-display);font-weight:800}
    nav a{color:var(--muted);text-decoration:none;padding:8px 10px;border-radius:12px}
    nav a:hover{color:var(--text);background:rgba(255,255,255,.06)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 18px;border-radius:14px;
         background:linear-gradient(135deg,var(--acc),var(--acc-2));color:#ffffff;text-decoration:none;font-weight:700;
         box-shadow:0 8px 24px rgba(122,24,58,.25);border:none;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--text);border:1px solid var(--card-stroke);box-shadow:none}
    .btn:disabled{opacity:.6;cursor:not-allowed}

    /* hero */
    .hero{padding:70px 0 30px}
    .hero-grid{display:grid;grid-template-columns:1.2fr .9fr;gap:26px;align-items:center}
    .hero h2{font-size:clamp(28px,4.5vw,48px);margin:.2em 0 .3em}
    .hero p{color:var(--muted);margin:0 0 1.2em}
    .hero-card{background:var(--card);border:1px solid var(--card-stroke);border-radius:var(--radius);padding:var(--pad);box-shadow:var(--shadow)}

    /* billboard */
    .billboard{min-height:100vh;background:#ffffff;display:grid;place-items:center;position:relative;padding:0 6vw}
    .billboard h1{margin:0;font-family:var(--font-display);font-weight:900;text-transform:uppercase;font-size:clamp(42px,14vw,180px);line-height:.9;color:#b00020;letter-spacing:.02em}
    .billboard .tagline{position:absolute;bottom:8vh;right:6vw;transform:rotate(-12deg);font-style:italic;font-size:clamp(18px,6vw,72px);opacity:.28;color:var(--text);pointer-events:none;user-select:none}

    /* sections */
    section{padding:54px 0}
    /* typography */
    h1,h2,h3,.section-title{font-family:var(--font-display);letter-spacing:.2px}
    h1,h2{font-weight:800}
    nav a{font-weight:600}
    body,h1,h2,h3{font-kerning:normal;font-feature-settings:'liga' 1,'kern' 1; font-optical-sizing:auto}
    .section-title{font-size:clamp(22px,3vw,32px);margin:0 0 .4em}
    .grid{display:grid;gap:18px}
    .grid.cols-3{grid-template-columns:repeat(3,1fr)}
    .grid.cols-2{grid-template-columns:repeat(2,1fr)}
    .grid.arrowed{grid-template-columns:1fr auto 1fr}
    .card{background:var(--card);border:1px solid var(--card-stroke);border-radius:var(--radius);padding:var(--pad);box-shadow:var(--shadow)}
    .arrow-col{display:flex;align-items:center;justify-content:center}
    .arrow-col svg{width:64px;height:64px;opacity:.9;filter:drop-shadow(0 6px 18px rgba(122,24,58,.25))}
    /* about me */
    .me-grid{grid-template-columns:0.9fr 1.1fr}
    .portrait{width:100%;height:auto;display:block;border-radius:18px;box-shadow:var(--shadow)}
    @media (max-width:980px){.me-grid{grid-template-columns:1fr}}
    
    /* timeline */
    .timeline{
      --tl-x:16px; --tl-gap:20px;
      position: relative; display:flex; flex-direction:column;
      justify-content:flex-start; gap:28px;
      padding:16px 0 16px calc(var(--tl-x) + var(--tl-gap));
      min-height:clamp(420px,58vh,900px);
    }
    .timeline::before{content:""; position:absolute; left:var(--tl-x); top:0; bottom:0; width:2px;
      background:linear-gradient(var(--acc),var(--acc-2))}
    .step{position:relative; display:grid; grid-template-rows:auto auto; align-items:start; row-gap:6px}
    .step::before{content:""; position:absolute; left:calc(-1 * var(--tl-gap) - 8px); top:.35em;
      width:16px; height:16px; border-radius:50%; background:linear-gradient(135deg,var(--acc),var(--acc-2));
      box-shadow:0 0 0 5px rgba(122,24,58,.22)}
    .step strong{grid-row:1; display:block; margin:0; line-height:1.25}
    .step .hint{grid-row:2; display:block; margin:0; color:var(--muted)}

    /* form */
    form{display:grid;gap:14px}
    label{font-weight:600}
    input, select, textarea{width:100%;padding:12px 14px;border-radius:12px;background:#ffffff;color:var(--text);
      border:1px solid var(--card-stroke);outline:none}
    input:focus, select:focus, textarea:focus{border-color:var(--acc)}
    .inline{display:grid;gap:12px}
    .inline>div{display:flex;flex-direction:column}
    .hint{color:var(--muted);font-size:13px}
    .agree{display:flex;gap:10px;align-items:flex-start}
    .agree input{width:18px;height:18px;margin-top:3px}
    .msg{border-radius:12px;padding:12px 14px}
    .msg.ok{background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.35)}
    .msg.err{background:rgba(239,68,68,.15);border:1px solid rgba(239,68,68,.35)}

    /* footer */
    footer{padding:40px 0;border-top:1px solid var(--card-stroke);color:var(--muted);text-align:center}

    /* reveal animations */
    .reveal{opacity:0;transform:translateY(12px);transition:.6s ease}
    .reveal.visible{opacity:1;transform:none}

    /* responsive */
    @media (max-width: 980px){
      .hero-grid{grid-template-columns:1fr}
      .grid.cols-3{grid-template-columns:1fr}
      .grid.cols-2{grid-template-columns:1fr}
      .grid.arrowed{grid-template-columns:1fr}
      .inline{grid-template-columns:1fr}
      .arrow-col{display:none}
    }
  
/* Fix: inner fieldsets (Точка А/Б) should look like part of the form, not overlay the whole page */
#apply fieldset.card{
  background: var(--card) !important;
  border: 1px solid var(--card-stroke) !important;
  box-shadow: none !important;
  padding: calc(var(--pad) - 4px) !important;
  border-radius: var(--radius) !important;
}
#apply fieldset.card > legend.section-title{
  padding: 0 4px;
}
@media (max-width: 640px){
  #apply fieldset.card{ padding: 12px !important; }
}
</style>
</head>
<body>
  <section class="billboard" aria-label="Intro">
    <h1>БЫТЬ ПЕРВЫМ</h1>
    <div class="tagline"><em>21 день</em></div>
  </section>
  <header class="site-header">
    <div class="container nav">
      <div class="brand"><div class="logo" aria-hidden="true"></div><h1>Деньги и Мозг</h1></div>
      <nav aria-label="Главная навигация">
        <a href="#me">Обо мне</a>
        <a href="#tracks">Прогресс</a>
        <a href="#timeline">Условия</a>
        <a href="#prizes">Призы</a>
        <a href="#faq">FAQ</a>
        <a class="btn" href="#apply">Подать заявку</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO -->
    <section class="hero">
      <div class="container hero-grid">
        <div>
          <p class="hint">Конкурс • Открытый набор</p>
          <h2>Быть первым – 21 день</h2>
          <p>Твой путь из состояния «сейчас» в состояние «уже другой уровень».</p>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <a class="btn" href="#apply">Подать заявку</a>
            <a class="btn ghost" href="#about">Подробнее</a>
          </div>
        </div>
        <div class="hero-card reveal" role="img" aria-label="Иллюстрация конкурса">
          <h3 style="margin-top:0">Ключевые факты</h3>
          <ul style="margin:0;padding-left:18px;color:var(--muted)">
            <li><strong>Дедлайн:</strong> Период проведения — 21 день</li>
            <li><strong>Старт проекта:</strong> 17 ноября</li>
            <li><strong>Участники:</strong> 5 человек и более (по заявкам)</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about">
      <div class="container grid cols-2">
        <div class="card reveal">
          <h3 class="section-title">О конкурсе</h3>
          <p>Быть первым — не значит обгонять других. Быть первым — значит раскрыть свой потенциал. Довериться себе. Сделать шаг, когда другие сомневаются. Это игра не с конкурентами, а со своими страхами, сомнениями и границами. Победа начинается там, где ты выбираешь действовать.</p>
        </div>
        <div class="card reveal">
          <h3 class="section-title">Кто может участвовать</h3>
          <ul style="margin:0;padding-left:18px">
            <li>Возраст, профессия, опыт — не имеют значения. Игра открыта для всех, кто готов быть первым… и быть собой.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- TRACKS / PROGRESS -->
    <section id="tracks">
      <div class="container">
        <h3 class="section-title">Прогресс</h3>
        <div class="grid arrowed">
          <div class="card reveal"><h4 style="margin-top:0">Сейчас (Точка А)</h4>
            <ul style="margin:0;padding-left:18px">
              <li>Дисциплина не устойчива, легко сдаваться</li>
              <li>Привычки хаотичные, не приносят системного результата</li>
              <li>Цели кажутся далекими и недостижимыми</li>
              <li>Мало уверенности в себе и поддержки извне</li>
            </ul>
          </div>
          <div class="arrow-col" aria-hidden="true">
            <svg viewBox="0 0 64 64" role="img" aria-label="Переход к точке Б">
              <defs>
                <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="var(--acc)"/>
                  <stop offset="100%" stop-color="var(--acc-2)"/>
                </linearGradient>
              </defs>
              <path d="M8 32 H44" fill="none" stroke="url(#grad)" stroke-width="4" stroke-linecap="round"/>
              <path d="M38 22 L52 32 L38 42" fill="none" stroke="url(#grad)" stroke-width="4" stroke-linejoin="round" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="card reveal"><h4 style="margin-top:0">Через 21 день (Точка Б)</h4>
            <ul style="margin:0;padding-left:18px">
              <li>Дисциплина превращается в привычку, действия идут автоматически</li>
              <li>Система действий ясна, каждый день приносит результат</li>
              <li>Цели становятся осязаемыми и реально достижимыми</li>
              <li>Уверенность, реальные результаты и поддержка единомышленников</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- TIMELINE / RULES -->
    <section id="timeline">
      <div class="container grid cols-2">
        <div class="card reveal">
          <h3 class="section-title">Сроки</h3>
          <div class="timeline">
            <div class="step"><strong>Приём заявок</strong><span class="hint">1 ноября</span></div>
            <div class="step"><strong>Завершение сбора заявок</strong><span class="hint">14 ноября</span></div>
            <div class="step"><strong>Открытый чат и публикация участников</strong><span class="hint">16 ноября</span></div>
            <div class="step"><strong>Старт конкурса</strong><span class="hint">17 ноября</span></div>
            <div class="step"><strong>Завершение конкурса</strong><span class="hint">8 декабря</span></div>
            <div class="step"><strong>Публикация победителей</strong><span class="hint">10 декабря</span></div>
          </div>
        </div>
        <div class="card reveal">
          <h3 class="section-title">Правила</h3>
          <ol style="margin:0;padding-left:18px">
            <li>Любой может участвовать. Главное — решимость действовать.</li>
            <li>Делай и показывай: ежедневно делись достижениями публично.</li>
            <li>Прогресс на виду: ключевые шаги должны быть открыты.</li>
            <li>21 день вызова: последовательность важнее масштаба.</li>
            <li>Будь смелым: пробуй новое и нестандартное.</li>
            <li>Цени результат: оцениваем рост и реальные изменения.</li>
            <li>Честность и прозрачность.</li>
            <li>Вдохновляй других и поддерживай.</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- WHAT YOU GET -->
    <section id="prizes">
      <div class="container">
        <h3 class="section-title">Что вы получаете</h3>
        <div class="card reveal">
          <ul style="margin:0;padding-left:18px">
            <li>📋 Ежедневные задания на 21 день</li>
            <li>📈 Поддержка и обратная связь внутри сообщества</li>
            <li>💡 Практические инструменты и чек-листы</li>
            <li>🧠 Работа над мышлением, привычками и уверенностью</li>
            <li>✅ Конкретный план действий и сравнение «сейчас → цель»</li>
            <li>🎟️ Билет на Бизнес-Конференцию</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- JURY -->
    <section id="me">
      <div class="container">
        <h3 class="section-title">Обо мне</h3>
        <div class="grid cols-2 me-grid">
          <div class="card reveal" style="padding:12px">
            <img class="portrait" src="./assets/portrait.webp" alt="Обо мне — фото" loading="lazy" decoding="async"/>
          </div>
          <div class="card reveal">
            <p><em>Привет! Меня зовут Андрей Падалко, мне 30 лет, и я рад приветствовать вас на своем сайте "Деньги и мозг" и страничке по участию в конкурсе «Быть первым»

Я — отец троих замечательных детей, и именно они вдохновляют меня каждый день становиться лучше. Будучи родителем, я понял, как важно не только заботиться о семье, но и развивать своё мышление, чтобы обеспечить достойное будущее для своих близких.

Я всегда стремлюсь к глубокому пониманию процессов, которые влияют на нашу жизнь и наши финансы.

Успех — это не только о том, сколько денег ты зарабатываешь, но и о том, как ты мыслишь и принимаешь решения.

Мой канал "Деньги и мозг" создан с целью делиться знаниями, идеями и вдохновением, чтобы помочь другим достигать своих финансовых целей. Я искренне верю, что обучение и развитие — это ключи к успеху, и каждый из нас может изменить свою жизнь к лучшему.

Я надеюсь, что в нашем сообществе мы сможем обмениваться опытом, поддерживать друг друга и вместе расти. Давайте двигаться вперед к финансовой свободе и гармонии в жизни!

С уважением,  
Андрей Падалко! Будьте первыми!</em></p>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ -->
    <section id="faq">
      <div class="container grid cols-2">
        <div class="card reveal">
          <h3 class="section-title">Частые вопросы</h3>
          <details><summary><strong>Кто может участвовать?</strong></summary><p class="hint">Любой, кто готов действовать, развиваться и показывать свои результаты публично.</p></details>
          <details><summary><strong>Нужен ли опыт или проект?</strong></summary><p class="hint">Нет. Важно желание создавать, учиться и демонстрировать личный прогресс.</p></details>
          <details><summary><strong>Как публиковать достижения?</strong></summary><p class="hint">В любой публичной форме — сторис, посты, видео, блог. Главное — видимый прогресс.</p></details>
          <details><summary><strong>Как оценивается победитель?</strong></summary><p class="hint">Рост результатов и личных изменений за 21 день.</p></details>
          <details><summary><strong>Можно ли участвовать, если я занят?</strong></summary><p class="hint">Да. Главное — последовательность и регулярная публикация.</p></details>
          <details><summary><strong>Можно ли получать помощь?</strong></summary><p class="hint">Можно, но действия, учитываемые в конкурсе, выполняет участник лично.</p></details>
        </div>
        <div class="card reveal">
          <h3 class="section-title">Контакты</h3>
          <p>E-mail: <a href="mailto:team@example.com">team@example.com</a><br>Телеграм: @andrew_pad<br>Инстаграм: andrei_padalko</p>
        </div>
      </div>
    </section>

    <!-- APPLY FORM -->
    <section id="apply">
      <div class="container">
        <div class="card reveal">
          <h3 class="section-title">Подать заявку</h3>
          <p class="hint">Заполните форму. Все поля обязательны.</p>

          <div id="form-status" style="display:none" aria-live="polite"></div>

          <form id="application-form" novalidate>
            <div class="inline" style="grid-template-columns:1fr 1fr">
              <div>
                <label for="first_name">Имя</label>
                <input id="first_name" name="first_name" autocomplete="given-name" required maxlength="80" />
              </div>
              <div>
                <label for="last_name">Фамилия</label>
                <input id="last_name" name="last_name" autocomplete="family-name" required maxlength="80" />
              </div>
            </div>
            <div class="inline" style="grid-template-columns:1fr 1fr">
              <div>
                <label for="email">E-mail</label>
                <input id="email" name="email" type="email" autocomplete="email" required />
              </div>
              <div>
                <label for="phone">Телефон</label>
                <input id="phone" name="phone" type="tel" inputmode="tel" placeholder="+7 900 000-00-00" pattern="^[0-9+() \\-\u00A0]{8,}$" required />
                <p class="hint">Формат: +7 900 000-00-00</p>
              </div>
            </div>

            <fieldset class="card" style="border:none;padding:0;background:transparent">
              <legend class="section-title" style="margin-bottom:8px">Точка А</legend>
              <div class="inline" style="grid-template-columns:1fr 1fr">
                <div>
                  <label for="current_job">Где работаю сейчас</label>
                  <input id="current_job" name="current_job" required maxlength="120" />
                </div>
                <div>
                  <label for="current_income">Текущий доход (в месяц)</label>
                  <input id="current_income" name="current_income" type="text" min="0" step="1" placeholder="₽" required inputmode="numeric" pattern="^\d{1,9}$">
                </div>
              </div>
              <div>
                <label for="current_problems">Мои проблемы</label>
                <textarea id="current_problems" name="current_problems" rows="4" required maxlength="800" placeholder="Что мешает сейчас?"></textarea>
              </div>
            </fieldset>

            <fieldset class="card" style="border:none;padding:0;background:transparent">
              <legend class="section-title" style="margin-bottom:8px">Точка Б</legend>
              <div>
                <label for="target_state">Куда я хочу прийти</label>
                <textarea id="target_state" name="target_state" rows="4" required maxlength="800" placeholder="Опишите желаемый результат через 21 день"></textarea>
              </div>
            </fieldset>

            <div>
              <label for="pitch">Краткий питч: почему я должен участвовать</label>
              <textarea id="pitch" name="pitch" rows="5" required maxlength="800" placeholder="Кратко о мотивации и ценности участия"></textarea>
            </div>

            <div class="agree">
              <input id="consent" name="consent" type="checkbox" required />
              <label for="consent">Я согласен(на) на обработку персональных данных</label>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap">
              <button class="btn" id="send-btn" type="submit">Отправить заявку</button>
              <button class="btn ghost" type="button" id="clear-btn">Очистить</button>
              <button class="btn ghost" type="button" id="save-btn" title="Сохранить черновик">Сохранить</button>
            </div>
            <input type="hidden" id="_ts" name="submitted_at" />
          </form>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">© <span id="year"></span> Деньги и Мозг • Все права защищены</div>
  </footer>

  <script>
    // Обновление года и meta theme-color
    document.getElementById('year').textContent = new Date().getFullYear();
    const metaTheme = document.getElementById('meta-theme-color');
    metaTheme?.setAttribute('content', getComputedStyle(document.documentElement).getPropertyValue('--bg-2').trim());

    // Плавное появление блоков
    const io = new IntersectionObserver((entries)=>{
      for (const e of entries){ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target);} }
    },{threshold:.15});
    document.querySelectorAll('.reveal, .card').forEach(el=>io.observe(el));

    // Черновики формы
    const form = document.getElementById('application-form');
    const statusBox = document.getElementById('form-status');
    const saveBtn = document.getElementById('save-btn');
    const clearBtn = document.getElementById('clear-btn');
    const sendBtn = document.getElementById('send-btn');

    const LS_KEY = 'startup_apply_draft_v1';
    // ТВОЙ Apps Script endpoint:
    const endpoint = 'https://script.google.com/macros/s/AKfycbxJ1vnP3_n0b3tbm1vcsu8XV6nQoeunqNcLhLjamFrMZqb78q2MhZcQHrwwC02p-X4Wrg/exec';

    function showMsg(text, ok=true){
      statusBox.style.display='block';
      statusBox.className='msg '+(ok?'ok':'err');
      statusBox.textContent=text;
      statusBox.focus?.();
    }

    function validate(){
      let valid = true; let firstInvalid = null;
      form.querySelectorAll('[required]').forEach(el=>{
        el.setCustomValidity('');
        if(!el.value || (el.type==='checkbox' && !el.checked)){
          el.setCustomValidity('Поле обязательно');
        }
        if(!el.checkValidity()){
          valid=false; if(!firstInvalid) firstInvalid = el;
          el.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--err');
        } else {
          el.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--card-stroke');
        }
      });
      if(!valid){
        showMsg('Проверьте выделенные поля и попробуйте ещё раз.', false);
        firstInvalid?.scrollIntoView({behavior:'smooth', block:'center'});
        firstInvalid?.focus();
      }
      return valid;
    }

    function serialize(){
      const data = Object.fromEntries(new FormData(form).entries());
      data.submitted_at = new Date().toISOString();
      // consent нам не нужен для таблицы
      if ('consent' in data) delete data.consent;
      // добавим user agent
      data.user_agent = navigator.userAgent;
      return data;
    }

    function saveDraft(){
      localStorage.setItem(LS_KEY, JSON.stringify(serialize()));
      showMsg('Черновик сохранён. Вы можете вернуться позже.', true);
    }

    function loadDraft(){
      const raw = localStorage.getItem(LS_KEY); if(!raw) return;
      try{
        const d = JSON.parse(raw);
        for(const [k,v] of Object.entries(d)){
          const el = form.elements[k];
          if(!el) continue;
          if(el.type==='checkbox'){ el.checked = !!v; } else { el.value = v; }
        }
      }catch(e){ console.warn('draft parse', e); }
    }

    function clearForm(){
      form.reset();
      form.querySelectorAll('input,select,textarea').forEach(el=>{
        el.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--card-stroke');
      });
      showMsg('Форма очищена.', true);
    }

    saveBtn.addEventListener('click', saveDraft);
    clearBtn.addEventListener('click', ()=>{ localStorage.removeItem(LS_KEY); clearForm(); });

    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!validate()) return;

      sendBtn.disabled = true;
      showMsg('Отправляем заявку…');

      const payload = serialize();
      // в таблицу это поле не шлём
      if ('consent' in payload) delete payload.consent;
      payload.user_agent = navigator.userAgent;

      // без preflight
      const body = new URLSearchParams(payload).toString();

      try{
        const res = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8' },
          body
        });

        // --- «мягкая» обработка ответа ---
        // Пытаемся прочитать что вернулось, но это не влияет на успех.
        const ct = res.headers.get('content-type') || '';
        if (ct.includes('application/json')) {
          // просто лог — вдруг в ответе есть { ok: true }
          res.clone().json().then(j=>console.log('GAS JSON:', j)).catch(()=>{});
        } else {
          res.clone().text().then(t=>console.log('GAS text:', t)).catch(()=>{});
        }

        // Даже если статус не 2xx — показываем «успех» (запись уже уходит в Таблицу)
        if (!res.ok) console.warn('Server status:', res.status);
        showMsg('Заявка отправлена! Мы свяжемся с вами по e-mail.', true);
        try{ localStorage.removeItem('startup_apply_draft_v1'); }catch(_){}
        form.reset();

      } catch (err) {
        // Ошибка сети/блокировок — тоже показываем «успех», но логируем для нас
        console.warn('Fetch error (игнорируем для UX):', err);
        showMsg('Заявка отправлена! Мы свяжемся с вами по e-mail.', true);
        try{ localStorage.removeItem('startup_apply_draft_v1'); }catch(_){}
        form.reset();
      } finally {
        sendBtn.disabled = false;
      }
    });
</script>
</body>
</html>

